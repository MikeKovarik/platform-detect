<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<style>
		* {
			box-sizing: border-box;
		}
		body {
			margin: 0;
			padding: 32px;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
		}
		[layout] {
			display: flex;
		}
		[layout][center] {
			align-items: center;
		}
		[layout][spaced] {
			margin: -16px;
		}
		[layout][spaced] > * {
			margin: 16px;
		}
		[flex] {
			flex: 1;
		}
		[secondary] {
			font-size: 13px;
			opacity: 0.6;
		}

		header {
			margin-bottom: 16px !important;
			align-items: center;
		}
		@media only screen and (max-width: 600px) {
			header {
				flex-direction: column;
				align-items: flex-start;
			}
		}

		main {
			flex-wrap: wrap;
		}
		main > * {
			width: 240px;
		}

		h1, h2 {
			margin: 0;
		}
		h2 {
			margin-bottom: 8px;
			font-weight: 500;
		}
		table {
			font-family: monospace;
			font-size: 16px;
			width: 100%;
		}
		tr + tr td {
			border-top: 1px solid #EEE;
		}

		#css-queries > * {
			display: none;
		}

		@media (pointer: coarse) {#pointer-coarse {display: inline-block}}
		@media (pointer: fine)   {#pointer-fine   {display: inline-block}}
		@media (pointer: none)   {#pointer-none   {display: inline-block}}
		@media (hover: hover)    {#hover-hover    {display: inline-block}}
		@media (hover: none)     {#hover-none     {display: inline-block}}

	</style>
</head>
<body>

	<header layout spaced>
		<h1>platform-detect</h1>
		<div flex secondary id="ua"></div>
	</header>

	<main layout spaced></main>

	<div id="css-queries">
		@media
		<div id="pointer-coarse">pointer: coarse</div>
		<div id="pointer-fine">(pointer: fine)</div>
		<div id="pointer-none">(pointer: none)</div>
		<div id="hover-hover">(hover: hover)</div>
		<div id="hover-none">(hover: none)</div>
	</div>

	<script src="index.js"></script>
	<script>
		var platform = window['platform-detect']
		var $main = document.querySelector('main')
		var $ua = document.querySelector('#ua')

		$ua.innerHTML += navigator.userAgent

		platform.onupdate = renderAll
		renderAll()

		function renderAll() {
			console.log('render')
			$main.innerHTML = ''
			renderGroup('OS', pick('windows', 'android', 'chromeos', 'macosx', 'linux', 'ios', 'tizen'))
			renderGroup('Runtime: specific', pick('web', 'pwa', 'uwp', 'cordova', 'chromeapp', 'nwjs', 'electron'))
			//renderGroup('Rendering engine', pick('edgeHtml', 'webkit', 'blink', 'gecko'))
			renderGroup('Browser', pick('edge', 'chrome', 'safari'))
			renderGroup('Runtime: general', pick('node', 'web', 'website', 'worker', 'serviceWorker'))
			renderGroup('Form factor', pick('formFactor', 'tabletMode'))
			renderGroup('Screen', pick('pixelRatio', 'touchscreen', 'inputType', 'mouse', 'touch', 'orientation', 'landscape', 'portrait'))
			renderGroup('Other', pick('hasWindow', 'isConsole', 'csp', 'dev'))
		}

		function renderGroup(name, data) {
			if (typeof data === 'object')
				data = objectToHtmlTable(data)
			$main.innerHTML += `
				<div>
					<h2>${name}</h2>
					${data}
				</div>
			`
		}

		function objectToHtmlTable(object) {
			var trs = Object.keys(object).map(key => `
				<tr>
					<td>${key}</td>
					<td>${JSON.stringify(object[key])}</td>
				</tr>
			`)
			return `<table>${trs.join('')}</table>`
		}

		function pickObject(input, ...keys) {
			var output = {}
			for (var key of keys)
				output[key] = input[key]
			return output
		}

		function pick(...keys) {
			return pickObject(platform, ...keys)
		}

	</script>

</body>
</html>
