<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<style>
		* {
			box-sizing: border-box;
		}
		body {
			margin: 0;
			padding: 32px;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
		}
		[layout] {
			display: flex;
		}
		[layout][center] {
			align-items: center;
		}
		[layout][spaced] {
			margin: -16px;
		}
		[layout][spaced] > * {
			margin: 16px;
		}
		[flex] {
			flex: 1;
		}
		[secondary] {
			font-family: 14px;
			opacity: 0.6;
		}
		.layout {
			flex-wrap: wrap;
		}
		.layout > * {
			width: 240px;
		}
		h1, h2 {
			margin: 0;
		}
		h2 {
			margin-bottom: 8px;
			font-weight: 500;
		}
		table {
			font-family: monospace;
			font-size: 16px;
			width: 100%;
		}
		tr + tr td {
			border-top: 1px solid #EEE;
		}
	</style>
</head>
<body>

	<div layout spaced center>
		<h1>platform-detect</h1>
		<div flex secondary id="ua"></div>
	</div>

	<div layout spaced class="layout"></div>

	<script src="index.js"></script>
	<script>
		var platform = window['platform-detect']
		var $layout = document.querySelector('.layout')
		var $ua = document.querySelector('#ua')

		$ua.innerHTML += navigator.userAgent

		platform.onupdate = renderAll
		renderAll()

		function renderAll() {
			console.log('render')
			$layout.innerHTML = ''
			renderGroup('OS', pick('windows', 'android', 'chromeos', 'macosx', 'linux', 'ios', 'tizen'))
			renderGroup('Runtime: specific', pick('web', 'pwa', 'uwp', 'cordova', 'chromeapp', 'nwjs', 'electron'))
			//renderGroup('Rendering engine', pick('edgeHtml', 'webkit', 'blink', 'gecko'))
			renderGroup('Browser', pick('edge', 'chrome', 'safari'))
			renderGroup('Runtime: general', pick('node', 'browser', 'worker', 'serviceWorker'))
			renderGroup('Form factor', pick('devieType', 'tabletMode'))
			renderGroup('Screen', pick('pixelRatio', 'touchscreen', 'pointer', 'mouse', 'touch', 'orientation', 'landscape', 'portrait'))
			renderGroup('Other', pick('window', 'console', 'csp', 'dev'))

			var suppl = {}
			suppl['window.outerWidth'] = window.outerWidth
			suppl['window.innerWidth'] = window.innerWidth
			suppl['window.outerHeight'] = window.outerHeight
			suppl['window.innerHeight'] = window.innerHeight

			renderGroup('Supplementary info', suppl)
		}

		function renderGroup(name, data) {
			if (typeof data === 'object')
				data = objectToHtmlTable(data)
			$layout.innerHTML += `
				<div>
					<h2>${name}</h2>
					${data}
				</div>
			`
		}

		function objectToHtmlTable(object) {
			var trs = Object.keys(object).map(key => `
				<tr>
					<td>${key}</td>
					<td>${JSON.stringify(object[key])}</td>
				</tr>
			`)
			return `<table>${trs.join('')}</table>`
		}

		function pickObject(input, ...keys) {
			var output = {}
			for (var key of keys)
				output[key] = input[key]
			return output
		}

		function pick(...keys) {
			return pickObject(platform, ...keys)
		}

	</script>

</body>
</html>
